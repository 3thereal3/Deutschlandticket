<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deutschlandticket</title>
    <style>
      @keyframes moveProgress {
        0% {
          transform: translateX(0);
          -webkit-transform: translateX(0);
        }
        100% {
          transform: translateX(calc(min(100vw, 500px) - 185px));
          -webkit-transform: translateX(calc(min(100vw, 500px) - 185px));
        }
      }
      @media (max-width: 500px) {
        @keyframes moveProgress {
          0% {
            transform: translateX(0);
            -webkit-transform: translateX(0);
          }
          100% {
            transform: translateX(calc(min(100vw, 500px) - 200px));
            -webkit-transform: translateX(calc(min(100vw, 500px) - 200px));
          }
        }
      }

      html,
      body {
        margin: 0;
        padding: 0;
        background-color: rgb(195, 10, 54); /* –æ—Å–Ω–æ–≤–Ω–æ–π –∫—Ä–∞—Å–Ω—ã–π */
      }

      .progress-bar {
        width: 100px;
        height: 6px;
        background: #007bff;
        border-radius: 3px;
        position: absolute;
        left: 0;
        will-change: transform;
        animation: moveProgress 2s linear infinite alternate;
      }
    </style>
    <script>
      const correctPassword = '1488'; // üîë –ó–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ —Å–≤—ñ–π –ø–∞—Ä–æ–ª—å
      const userPassword = prompt('–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø—É:');
      if (!userPassword) {
        // –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –≤–≤—ñ–≤ –ø–∞—Ä–æ–ª—å, –∑—É–ø–∏–Ω—è—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.documentElement.innerHTML =
          '<h2 style="color:white;text-align:center">‚õî –î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ</h2>';
        throw new Error('Access denied: No password provided');
      }
      if (userPassword !== correctPassword) {
        // –ó—É–ø–∏–Ω—è—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.documentElement.innerHTML =
          '<h2 style="color:white;text-align:center">‚õî –î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ</h2>';
        throw new Error('Wrong password');
      }

      function replaceImage(event, targetId) {
        const reader = new FileReader();
        reader.onload = function () {
          document.getElementById(targetId).src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
      }
    </script>
  </head>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <body>
    <div id="root">
      <div
        style="
          background: rgb(195, 10, 54);
          display: flex;
          justify-content: center;
          align-items: center;
          padding: 10px;
        "
      >
        <div
          style="
            max-width: 500px;
            width: 100%;
            display: flex;
            flex-direction: column;
            border: 2px solid rgb(202, 218, 243);
            border-radius: 20px;
            flex-grow: 1;
            overflow: hidden;
            box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 8px;
          "
        >
          <h4
            style="
              padding: 20px;
              font-weight: 500;
              color: rgb(255, 255, 255);
              font-size: 20px;
              text-align: center;
              background: linear-gradient(90deg, rgb(242, 104, 137), rgb(195, 10, 54));
            "
          >
            Deutschlandticket
          </h4>
          <div
            style="
              background: rgb(249, 251, 250);
              display: flex;
              flex-direction: column;
              color: rgb(98, 107, 128);
            "
          >
            <div
              style="
                background: rgb(255, 255, 255);
                padding: 20px;
                display: flex;
                flex-direction: column;
                gap: 20px;
              "
            >
              <div
                style="display: flex; justify-content: center; gap: 20px; padding: 20px"
              >
                <input
                  type="file"
                  accept="image/*"
                  onchange="replaceImage(event, 'img1')"
                  style="display: none"
                  id="file1"
                />
                <img
                  src="./img/ETicket_Logo.svg"
                  id="img1"
                  alt="ETicket Logo"
                  style="height: 27px; cursor: pointer"
                  onclick="document.getElementById('file1').click()"
                />

                <input
                  type="file"
                  accept="image/*"
                  onchange="replaceImage(event, 'img2')"
                  style="display: none"
                  id="file2"
                />
                <img
                  src="./img/Icon_Deutschlandticket.png"
                  id="img2"
                  alt="Deutschlandticket Logo"
                  style="height: 27px; cursor: pointer"
                  onclick="document.getElementById('file2').click()"
                />

                <input
                  type="file"
                  accept="image/*"
                  onchange="replaceImage(event, 'img3')"
                  style="display: none"
                  id="file3"
                />
                <img
                  src="./img/Verkehrsbetriebe_Karlsruhe_logo.svg"
                  id="img3"
                  alt="Kvv Logo"
                  style="height: 27px; cursor: pointer"
                  onclick="document.getElementById('file3').click()"
                />
              </div>
              <div style="display: flex; justify-content: center; width: 100%">
                <input
                  type="file"
                  accept="image/*"
                  onchange="replaceImage(event, 'mainImg')"
                  style="display: none"
                  id="mainFile"
                />
                <img
                  id="mainImg"
                  src="https://abo-ride.shop/uploads/1748780305599.jpg"
                  alt="Main QR"
                  style="
                    max-width: 100%;
                    height: auto;
                    width: auto;
                    object-fit: contain;
                    cursor: pointer;
                  "
                  onclick="document.getElementById('mainFile').click()"
                />
              </div>

              <div
                style="
                  padding: 20px;
                  border: 1px solid rgb(235, 235, 235);
                  border-radius: 8px;
                  text-align: center;
                  font-size: 20px;
                  color: rgb(51, 51, 51);
                  font-weight: bold;
                  box-shadow: rgba(14, 63, 126, 0.06) 0px 0px 0px 1px,
                    rgba(42, 51, 70, 0.03) 0px 1px 1px -0.5px,
                    rgba(42, 51, 70, 0.04) 0px 2px 2px -1px,
                    rgba(42, 51, 70, 0.04) 0px 3px 3px -1.5px,
                    rgba(42, 51, 70, 0.03) 0px 5px 5px -2.5px,
                    rgba(42, 51, 70, 0.03) 0px 10px 10px -5px,
                    rgba(42, 51, 70, 0.03) 0px 24px 24px -8px;
                "
              >
                <div
                  contenteditable="true"
                  style="font-weight: bold; color: rgb(0, 0, 0)"
                >
                  60147257
                </div>
                <div
                  style="
                    width: 100%;
                    height: 6px;
                    background: rgb(204, 204, 204);
                    border-radius: 3px;
                    overflow: hidden;
                    margin-top: 10px;
                    position: relative;
                  "
                >
                  <div class="progress-bar"></div>
                </div>
              </div>
            </div>
            <div
              style="
                padding: 20px;
                display: flex;
                flex-direction: column;
                gap: 5px;
                border-top: 1.5px solid rgb(230, 232, 231);
              "
            >
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  padding-left: 40px;
                  position: relative;
                "
              >
                <div style="display: flex; align-items: center">
                  <div
                    style="
                      position: absolute;
                      left: 0px;
                      width: 40px;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M12 2C6.47717 2 2 6.47717 2 12C2 17.5228 6.47717 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47717 17.5228 2 12 2ZM12 21.25C6.89954 21.25 2.75 17.1005 2.75 12C2.75 6.89954 6.89954 2.75 12 2.75C17.1005 2.75 21.25 6.89954 21.25 12C21.25 17.1005 17.1005 21.25 12 21.25Z"
                        fill="#000000"
                      ></path>
                      <path
                        d="M17.25 11.625H12.375V5.75C12.375 5.54297 12.207 5.375 12 5.375C11.793 5.375 11.625 5.54297 11.625 5.75V12C11.625 12.207 11.793 12.375 12 12.375H17.25C17.457 12.375 17.625 12.207 17.625 12C17.625 11.793 17.457 11.625 17.25 11.625Z"
                        fill="#000000"
                      ></path>
                    </svg>
                  </div>
                  G√ºltig von
                </div>
                <div
                  style="
                    display: flex;
                    align-items: center;
                    font-weight: bold;
                    color: rgb(0, 0, 0);
                  "
                >
                  <div
                    contenteditable="true"
                    style="font-weight: bold; color: rgb(0, 0, 0)"
                  >
                    01.06.2025 - 00:00
                  </div>
                </div>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  padding-left: 40px;
                  position: relative;
                "
              >
                <div style="display: flex; align-items: center">G√ºltig bis</div>
                <div
                  style="
                    display: flex;
                    align-items: center;
                    font-weight: bold;
                    color: rgb(0, 0, 0);
                  "
                >
                  <div
                    contenteditable="true"
                    style="font-weight: bold; color: rgb(0, 0, 0)"
                  >
                    01.07.2025 - 03:00
                  </div>
                </div>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  padding-left: 40px;
                  position: relative;
                "
              >
                <div style="display: flex; align-items: center">Geltungsbereich</div>
                <div
                  style="
                    display: flex;
                    align-items: center;
                    font-weight: bold;
                    color: rgb(0, 0, 0);
                  "
                >
                  <div
                    contenteditable="true"
                    style="font-weight: bold; color: rgb(0, 0, 0)"
                  >
                    Deutschlandweit
                  </div>
                </div>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  padding-left: 40px;
                  position: relative;
                "
              >
                <div style="display: flex; align-items: center">Klasse</div>
                <div
                  style="
                    display: flex;
                    align-items: center;
                    font-weight: bold;
                    color: rgb(0, 0, 0);
                  "
                >
                  <div
                    contenteditable="true"
                    style="font-weight: bold; color: rgb(0, 0, 0)"
                  >
                    2. Klasse
                  </div>
                </div>
              </div>
            </div>
            <div
              style="
                padding: 20px;
                display: flex;
                flex-direction: column;
                gap: 5px;
                border-top: 1.5px solid rgb(230, 232, 231);
              "
            >
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  padding-left: 40px;
                  position: relative;
                "
              >
                <div style="display: flex; align-items: center">
                  <div
                    style="
                      position: absolute;
                      left: 0px;
                      width: 40px;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M14.3796 16.3257C13.7183 15.9772 13.0208 15.7169 12.3061 15.5377C14.473 14.632 16 12.4916 16 10C16 6.69141 13.3086 4 10 4C6.69141 4 4 6.69141 4 10C4 12.4913 5.52655 14.6315 7.693 15.5374C6.97809 15.7166 6.28046 15.977 5.61902 16.3257C4.26117 17.0417 3.03559 18.1038 2.07422 19.3975C1.95069 19.5641 1.98487 19.8005 2.15088 19.9251C2.31739 20.0496 2.55176 20.0153 2.67578 19.8486C3.57025 18.6442 4.70844 17.6566 5.96765 16.9927C8.47541 15.6706 11.5242 15.6706 14.0319 16.9927C15.2917 17.6566 16.4293 18.6442 17.3239 19.8486C17.3981 19.9476 17.5104 19.9996 17.6246 19.9996C17.7028 19.9996 17.7819 19.9751 17.8492 19.9251C18.0153 19.8005 18.0494 19.5641 17.9254 19.3975C16.9645 18.1038 15.738 17.0417 14.3796 16.3257ZM4.75 10C4.75 7.10498 7.10498 4.75 10 4.75C12.895 4.75 15.25 7.10498 15.25 10C15.25 12.895 12.895 15.25 10 15.25C7.10498 15.25 4.75 12.895 4.75 10Z"
                        fill="#000000"
                      ></path>
                      <path
                        d="M22.8124 13.9877L22.1226 13.5895C22.1847 13.4031 22.2264 13.2073 22.2264 13C22.2264 12.7927 22.1847 12.5969 22.1226 12.4105L22.8124 12.0123C22.9918 11.9087 23.0532 11.6794 22.9497 11.5C22.8461 11.3206 22.6168 11.2592 22.4374 11.3627L21.7485 11.7605C21.4841 11.4627 21.1318 11.2451 20.7266 11.1628V10.375C20.7266 10.1679 20.5587 10 20.3516 10C20.1445 10 19.9766 10.1679 19.9766 10.375V11.1628C19.5714 11.245 19.2189 11.4625 18.9545 11.7603L18.2658 11.3627C18.0864 11.2592 17.8571 11.3206 17.7535 11.5C17.65 11.6794 17.7114 11.9087 17.8908 12.0123L18.5802 12.4103C18.5181 12.5967 18.4764 12.7927 18.4764 13C18.4764 13.2073 18.5181 13.4033 18.5802 13.5897L17.8908 13.9877C17.7114 14.0913 17.65 14.3206 17.7535 14.5C17.8571 14.6794 18.0864 14.7408 18.2658 14.6373L18.9545 14.2397C19.2189 14.5375 19.5714 14.755 19.9766 14.8372V15.625C19.9766 15.8321 20.1445 16 20.3516 16C20.5587 16 20.7266 15.8321 20.7266 15.625V14.8372C21.1318 14.7549 21.4841 14.5373 21.7485 14.2395L22.4374 14.6373C22.6168 14.7408 22.8461 14.6794 22.9497 14.5C23.0532 14.3206 22.9918 14.0913 22.8124 13.9877ZM20.3514 14.125C19.7311 14.125 19.2264 13.6204 19.2264 13C19.2264 12.3797 19.7311 11.875 20.3514 11.875C20.9717 11.875 21.4764 12.3797 21.4764 13C21.4764 13.6204 20.9717 14.125 20.3514 14.125Z"
                        fill="#000000"
                      ></path>
                    </svg>
                  </div>
                  Ticketinhaber*in
                </div>
                <div
                  style="
                    display: flex;
                    align-items: center;
                    font-weight: bold;
                    color: rgb(0, 0, 0);
                  "
                >
                  <div
                    contenteditable="true"
                    style="font-weight: bold; color: rgb(0, 0, 0)"
                  >
                    Ramir Kovach
                  </div>
                </div>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  padding-left: 40px;
                  position: relative;
                "
              >
                <div style="display: flex; align-items: center">
                  <div
                    style="
                      position: absolute;
                      left: 0px;
                      width: 40px;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M8 13C7.44772 13 7 13.4477 7 14C7 14.5523 7.44772 15 8 15H8.00897C8.56126 15 9.00897 14.5523 9.00897 14C9.00897 13.4477 8.56126 13 8.00897 13H8Z"
                        fill="#000000"
                      ></path>
                      <path
                        d="M11.9955 13C11.4432 13 10.9955 13.4477 10.9955 14C10.9955 14.5523 11.4432 15 11.9955 15H12.0045C12.5568 15 13.0045 14.5523 13.0045 14C13.0045 13.4477 12.5568 13 12.0045 13H11.9955Z"
                        fill="#000000"
                      ></path>
                      <path
                        d="M14.991 14C14.991 13.4477 15.4387 13 15.991 13H16C16.5523 13 17 13.4477 17 14C17 14.5523 16.5523 15 16 15H15.991C15.4387 15 14.991 14.5523 14.991 14Z"
                        fill="#000000"
                      ></path>
                      <path
                        d="M8 17C7.44772 17 7 17.4477 7 18C7 18.5523 7.44772 19 8 19H8.00897C8.56126 19 9.00897 18.5523 9.00897 18C9.00897 17.4477 8.56126 17 8.00897 17H8Z"
                        fill="#000000"
                      ></path>
                      <path
                        d="M10.9955 18C10.9955 17.4477 11.4432 17 11.9955 17H12.0045C12.5568 17 13.0045 17.4477 13.0045 18C13.0045 18.5523 12.5568 19 12.0045 19H11.9955C11.4432 19 10.9955 18.5523 10.9955 18Z"
                        fill="#000000"
                      ></path>
                      <path
                        fill-rule="evenodd"
                        clip-rule="evenodd"
                        d="M8.375 2C8.58211 2 8.75 2.16722 8.75 2.37351V4H15.25V2.37351C15.25 2.16722 15.4179 2 15.625 2C15.8321 2 16 2.16722 16 2.37351V4H17C19.2091 4 21 5.79086 21 8V18C21 20.2091 19.2091 22 17 22H7C4.79086 22 3 20.2091 3 18V8C3 5.79086 4.79086 4 7 4H8V2.37351C8 2.16722 8.16789 2 8.375 2ZM15.25 4.75V6.62649C15.25 6.83278 15.4179 7 15.625 7C15.8321 7 16 6.83278 16 6.62649V4.75H17C18.7949 4.75 20.25 6.20507 20.25 8V9.625H3.75V8C3.75 6.20507 5.20507 4.75 7 4.75H8V6.62649C8 6.83278 8.16789 7 8.375 7C8.58211 7 8.75 6.83278 8.75 6.62649V4.75H15.25ZM3.75 18V10.375H20.25V18C20.25 19.7949 18.7949 21.25 17 21.25H7C5.20507 21.25 3.75 19.7949 3.75 18Z"
                        fill="#000000"
                      ></path>
                    </svg>
                  </div>
                  Geburtsdatum
                </div>
                <div
                  style="
                    display: flex;
                    align-items: center;
                    font-weight: bold;
                    color: rgb(0, 0, 0);
                  "
                >
                  <div
                    contenteditable="true"
                    style="font-weight: bold; color: rgb(0, 0, 0)"
                  >
                    17.04.2007
                  </div>
                </div>
              </div>
            </div>
            <div
              contenteditable="true"
              style="
                padding: 20px;
                display: flex;
                flex-direction: column;
                gap: 5px;
                border-top: 1.5px solid rgb(230, 232, 231);
              "
            >
              Deutschlandweit g√ºltig f√ºr eine Person in allen Nahverkehrsmitteln
              (√ñPNV/SPNV), 2. Klasse.
            </div>
          </div>
        </div>
      </div>
    </div>
    <div style="padding: 20px; background: white; text-align: center">
      <input type="text" id="username" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º‚Äô—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è" />
      <button onclick="saveCard()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
    </div>

    <script>
      async function saveCard() {
        const username = document.getElementById('username').value.trim();
        if (!username) return alert('–í–≤–µ–¥—ñ—Ç—å —ñ–º‚Äô—è!');

        const texts = Array.from(
          document.querySelectorAll('[contenteditable="true"]')
        ).map(div => div.innerText);
        const images = ['img1', 'img2', 'img3', 'mainImg'].map(id => {
          const img = document.getElementById(id);
          return img ? img.src : '';
        });

        const payload = {
          name: username,
          texts,
          images,
        };

        const res = await fetch('/save', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(payload),
        });

        if (res.ok) {
          alert(
            '–ö–∞—Ä—Ç–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–æ! –ü–æ—Å–∏–ª–∞–Ω–Ω—è: ' + window.location.origin + '/card/' + username
          );
        } else {
          alert('–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.');
        }
      }
    </script>
  </body>
</html>
